---
layout: post
title:  "[HTTP: The Definitive Guide] 2. URL & Resource"
date:   2018-01-26 18:29:16 +0900
background: '/img/posts/04.jpg'
categories: http
---

## 인터넷에서 리소스 탐색하기
---
대부분의 URL은 `scheme://host/resource` 구조로 이루어져 있다. 이는 어떻게, 어디에, 무엇을
탐색할지 식별할 수 있는 명명 방식이다.

## URL이 있기 전 암흑의 시대
--- 
URL이 있기 전, 'A'라는 파일을 공유하기 위해서는
1. 해당 파일이 존재하는 ftp 서버로 접속한다.
2. 전달 받은 아이디와 비밀번호로 로그인한다.
3. 지정된 디렉토리로 이동한 후, 파일을 바이너리 형식으로 전환한다.
4. 해당 파일을 로컬 파일 시스템에 내려 받는다.

URL은 애플리케이션이 리소스에 접근하는 방법을 제공한다. 위와 같은 복잡한 과정 대신, 단순히
브라우저에 'A' 파일에 대한 URL만 입력하면 다운로드가 된다.

## URL 문법
---
URL 문법은 스킴에 따라 달라진다. 대부분의 URL 스킴의 문법은 9개 부분으로 나눠진다.\\
`<scheme>://<user_name>:<password>@<host>:<port>/<resource>;<parameter>?<query>#<fragment>`

이 모든 컴포넌트를 가지는 URL은 거의 없다.

- 스킴 명은 대소문자를 가리지 않으며, 반드시 알파벳으로 시작해야한다.
- 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킨다. 내부적으로 TCP 프로토콜을
사용하는 HTTP는 기본 포트로 80을 사용한다.
- 사용자 이름과 비밀번호 컴포넌트는 FTP 서버가 좋은 예이다. 생략 시 기본 사용자 이름으로
`anonymous`, 비밀번호로 브라우저마다 가지고 있는 `기본값`이 들어간다.
- 리소스 컴포넌트는 계층적 파일 시스템 경로와 유사한 구조를 갖는다.
- 파라미터 컴포넌트는 애플리케이션 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터
를 입력 받는데 사용한다. `이름/값 쌍`의 리스트로, ';'문자로 구분되어 기술된다.
- 질의 문자열 파라미터는 데이터베이스 같은 서비스에서 리소스 형식의 범위를 줄이기 위해
사용된다. '?' 우측의 값으로 `이름=값 쌍` 형식을 필요로 한다.
- 프래그먼트 컴포넌트는 리소스 일부를 보여주기 위해 사용된다. 그러나 HTTP 서버는 객체
일부를 다루지 않기에, 에이전트는 전체 객체를 받은 후 프래그먼트 식별자를 사용하여 일부만
표시해준다.(프래그먼트는 서버로 보내지지 않는다.)

## 절대 URL
---
리소스에 접근하는데 필요한 모든 정보를 가진 URL이다. 예시에 쓰인 것이 절대 URL이다.

## 상대 URL
---
모든 정보를 담고 있지 않다. 상대 URL로 리소스에 접근하는데 필요한 모든 정보를 얻기 위해서는
기저(base)라고 하는 다른 URL을 사용해야한다.

`./hammer.html`과 같은 URL을 상대 URL이라 하며, 이는 프래그먼트이거나 URL 일부이다.

상대 URL을 사용하면 리소스 집합을 쉽게 변경할 수 있다. 그리고 문서 집합의 위치를 변경하더라도,
새로운 기저 URL에 의해 해석될 것이기에 잘 동작할 것이다. 이는 마치 다른 서버에 있는 콘텐츠를 미
러링 할 수 있게 허용하는 것과 유사하다.

리소스는 기저 URL을 리소스에서 명시적으로 기술하거나(HTML 내 BASE TAG 사용), 명시되지 않았
을 경우 해당 리소스의 URL을 기저 URL로 사용한다.

단순한 URL 파싱을 통해 상대 URL을 절대 URL로 변환시킬 수 있다.

## URL 확장
---
어떤 브라우저들은 URL을 입력한 다음이나 입력받고 있는 동안에 자동으로 URL을 확장한다.
1. 호스트명 확장
: 단순한 휴리스틱만을 사용해서 입력 호스트 명을 전체 호스트 명으로 확장한다.
2. 히스토리 확장
: URL 입력 시간을 줄이고자 과거 방문했던 URL 기록을 저장해놓는 기능이다.

프록시를 사용할 경우 URL 자동확장 기능은 다르게 동작할 수 있다.

## 안전하지 않은 문자
---
전자메일에 사용되는 `SMTP(Simple Mail Transfer Protocol)`같은 프로토콜은 7bit 인코딩을 
사용하기 때문에 8bit 이상으로 인코딩되어 있으면 정보가 소실될 수 있다.

URL은 안전한 알파벳 문자만 포함하도록 설계되어야 하며, 공백과 같이 문자의 사용을 금지한다.

알파벳이외의 불안전한 문자는 이스케이프라는 기능으로 인코딩 가능하다.

브라우저와 같이 최초로 URL을 입력받는 애플리케이션에서 인코딩을 하는 것이 가장 바람직하다.

## 이스케이프 문자
---
퍼센테이지 기호(%)로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어졌다.

## URL의 단점
---
리소스가 옮겨지면 해당 URL을 더이상 사용할 수 없다는 점이다. 이를 위해 `URN`이나, URL로 URN의
기능을 사용할 수 있는 `PURL`이 대안으로 제시되고 있다.

그러나 URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업이고, 엄청난 비용과 시간을 초래하
기에 URL은 계속 사용될 것이다.

## Reference
---
HTTP: The Definitive Guide